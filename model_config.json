{
    "env": {
        "USE_GPU": 0
    },

    "dataset": {
        "select_dataset": "sentiment",
        "sst": {
            "granularity": "5-class",
            "transformer_model_name": "roberta-base",
            "use_subtrees": false,
            "proportion": 1,
            "max_length": 500,
            "review_field_name": "tokens",
            "label_field_name": "label"
        },
        "yelp": {
            "proportion": 1,
            "transformer_model_name": "roberta-base",
            "review_field_name": "tokens",
            "label_field_name": "label"
        },
        "sentiment": {
            "datapath": "data/subj/SUBJ.pkl",
            "transformer_model_name": "roberta-base",
            "max_length": 500,
            "review_field_name": "tokens",
            "label_field_name": "label"
        }
    },

    "text_model": {
        "embedder": {
            "select_embedder": "transformer_embedder",
            "word_embedder": {
                "pretrained_embedding": {
                    "embedding_dim": 300,
                    "pretrained_filepath": "pretrained_weight/glove.840B.300d.txt"
                },
                "embedding_dim": 300,
                "trainable": {
                    "trainable": true,
                    "projection_dim": 300
                }
            },
            "transformer_embedder": {
                "model_name": "roberta-base",
                "train_parameters": true
            }
        },
        "encoder": {
            "select_encoder": "transformer_encoder",
            "word_encoder": {
                "s2s_encoder": {
                    "hidden_size": 300,
                    "num_layers": 3,
                    "bidirectional": true
                },
                "s2v_encoder": {
                    "hidden_size": 300,
                    "num_layers": 3,
                    "bidirectional": true
                }
            },
            "transformer_encoder": {
                "model_name": "roberta-base",
                "dropout": 0.3
            }
        },
        "classifier": {
            "feedforward": {
                "num_layers": 1,
                "hidden_dims": [50],
                "activations": "silu",
                "dropout": 0.3
            }
        },
        "optimizer": {
            "select_optimizer": "adamw",
            "lr": 1e-5
        },
        "scheduler": {
            "select_scheduler": "reduce",
            "training_steps": 3204,
            "warmup_steps": 192
        },
        "criterions": {
            "classification_criterion": "cross_entropy",
            "contrastive_criterion": "consine_embedding"
        },
        "evaluation": "categorical",
        "clip_grad": {
            "is_clip": true,
            "max_norm": 0.9,
            "norm_type": 2
        }
    },

    "reinforcer": {
        "environment": {
            "similarity_threshold": 0.9
        },

        "augmenter": {
            "synonyms": {
                "synonyms_filepath": null
            },
            "select_augmenter": [0, 1, 2, 3],
            "delete_augmenter": {
                "padded_idx": 0,
                "oov_idx": 24,
                "magnitude": 0.1
            },
            "swap_augmenter": {
                "padded_idx": 0,
                "oov_idx": 1,
                "magnitude": 1
            },
            "replace_augmenter": {
                "padded_idx": 0,
                "oov_idx": 1,
                "magnitude": 0.1
            },
            "insert_augmenter": {
                "padded_idx": 0,
                "oov_idx": 1,
                "magnitude": 0.1
            },
            "backtrans_augmenter": {
                "from_model_name": "Helsinki-NLP/opus-mt-en-de",
                "to_model_name": "Helsinki-NLP/opus-mt-de-en",
                "device": "cuda",
                "magnitude": 1
            }
        },

        "policy": {
            "feedforward": {
                "num_layers": 4,
                "hidden_dims": [64, 32, 16],
                "activations": "relu",
                "dropout": 0.2
            },

            "optimizer": {
                "select_optimizer": "adam",
                "lr": 1e-3
            }
        },

        "REINFORCE": {
            "gamma": 0.99,
            "clip_grad": 10,
            "max_step": 20
        }
    },

    "visualizer": {
        "mode": "isomap",
        "tsne": {
            "col_names": [
                "tsne_1",
                "tsne_2",
                "category"
            ],
            "n_components": 2,
            "perplexity": [
                5, 10, 15, 20, 30,
                40, 50, 60, 70, 80,
                90, 100, 110, 120, 130,
                140, 150, 200, 300, 500,
                750, 1000
            ],
            "n_iter": 1000,
            "verbose": 1,
            "save_fig_path": "model_record/visual/"
        },
        "isomap": {
            "col_names": [
                "isomap_1",
                "isomap_2",
                "category"
            ],
            "n_neighbors": 5,
            "n_components": 2,
            "n_jobs": 6,
            "save_fig_path": "model_record/visual/isomap/"
        }
    },

    "train_mode": {
        "select_mode": 0,
        "0": {
            "text_trainer": {
                "dataloader": {
                    "train_batch_size": 32,
                    "valid_batch_size": 200,
                    "test_batch_size": 200,
                    "shuffle": true
                },
                "accumulated_step": 1,
                "epochs": 12,
                "is_save": true
            },
            "reinforce_trainer": {
                "dataloader": {
                    "shuffle": true
                },
                "epochs": 1,
                "is_save": true,
                "is_writer": true,
                "batch_size": 120
            },
            "augmented_instance_generator": {
                "num_processor": 3,
                "select_mode": "eda",
                "select_policy": [
                    "model_record/reinforce_model_weights/policy11",
                    "model_record/reinforce_model_weights/policy21",
                    "model_record/reinforce_model_weights/policy31",
                    "model_record/reinforce_model_weights/policy12",
                    "model_record/reinforce_model_weights/policy22",
                    "model_record/reinforce_model_weights/policy32",
                    "model_record/reinforce_model_weights/policy13",
                    "model_record/reinforce_model_weights/policy23",
                    "model_record/reinforce_model_weights/policy33"
                ],
                "save_name": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment21",
                    "model_record/augments/augment31",
                    "model_record/augments/augment12",
                    "model_record/augments/augment22",
                    "model_record/augments/augment32",
                    "model_record/augments/augment13",
                    "model_record/augments/augment23",
                    "model_record/augments/augment33"
                ]
            },
            "text_finetuner": {
                "dataloader": {
                    "train_batch_size": 9,
                    "valid_batch_size": 66,
                    "test_batch_size": 66,
                    "shuffle": true
                },
                "accumulated_step": 30,
                "epochs": 36,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment21",
                    "model_record/augments/augment31",
                    "model_record/augments/augment12",
                    "model_record/augments/augment22",
                    "model_record/augments/augment32",
                    "model_record/augments/augment13",
                    "model_record/augments/augment23",
                    "model_record/augments/augment33"
                ]
            }
        },
        "1": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },
            "reinforce_trainer": {
                "dataloader": {
                    "shuffle": true
                },
                "epochs": 3,
                "is_save": true,
                "is_writer": true,
                "batch_size": 60
            },
            "augmented_instance_generator": {
                "num_processor": 1,
                "select_mode": "default",
                "select_policy": [
                    "model_record/reinforce_model_weights/policy11",
                    "model_record/reinforce_model_weights/policy21",
                    "model_record/reinforce_model_weights/policy31",
                    "model_record/reinforce_model_weights/policy12",
                    "model_record/reinforce_model_weights/policy22",
                    "model_record/reinforce_model_weights/policy32",
                    "model_record/reinforce_model_weights/policy13",
                    "model_record/reinforce_model_weights/policy23",
                    "model_record/reinforce_model_weights/policy33"
                ],
                "save_name": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment21",
                    "model_record/augments/augment31",
                    "model_record/augments/augment12",
                    "model_record/augments/augment22",
                    "model_record/augments/augment32",
                    "model_record/augments/augment13",
                    "model_record/augments/augment23",
                    "model_record/augments/augment33"
                ]
            },
            "text_finetuner": {
                "dataloader": {
                    "train_batch_size": 9,
                    "valid_batch_size": 66,
                    "test_batch_size": 66,
                    "shuffle": true
                },
                "accumulated_step": 30,
                "epochs": 24,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment21",
                    "model_record/augments/augment31",
                    "model_record/augments/augment12",
                    "model_record/augments/augment22",
                    "model_record/augments/augment32",
                    "model_record/augments/augment13",
                    "model_record/augments/augment23",
                    "model_record/augments/augment33"
                ]
            }
        },
        "2": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },
            "augmented_instance_generator": {
                "num_processor": 1,
                "select_mode": "backtrans",
                "select_policy": [
                    "model_record/reinforce_model_weights/policy3"
                ],
                "save_name": [
                    "model_record/augments/augment3"
                ]
            },
            "text_finetuner": {
                "dataloader": {
                    "train_batch_size": 9,
                    "valid_batch_size": 66,
                    "test_batch_size": 66,
                    "shuffle": true
                },
                "accumulated_step": 30,
                "epochs": 1200,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment1"
                ]
            }
        },
        "3": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },
            "text_finetuner": {
                "dataloader": {
                    "train_batch_size": 32,
                    "valid_batch_size": 60,
                    "test_batch_size": 60,
                    "shuffle": true
                },
                "accumulated_step": 1,
                "epochs": 12,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment3"
                ]
            }
        },

        "4": {
            "text_trainer": {
                "dataloader": {
                    "train_batch_size": 16,
                    "valid_batch_size": 200,
                    "test_batch_size": 200,
                    "shuffle": true
                },
                "accumulated_step": 2,
                "epochs": 12,
                "is_save": true,
                "augmented_instance": [
                    "model_record/augments/augment1"
                ]
            }
        },

        "5": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },

            "visualizer": {
                "batch_size": 300,
                "proportion": 1,
                "sim_comparison": {
                    "is_sim_comparison": false,
                    "comparison_dict": {
                        "sim_0.7": [
                            "sim_0.7/augments/augment11",
                            "sim_0.7/augments/augment12",
                            "sim_0.7/augments/augment13",
                            "sim_0.7/augments/augment21",
                            "sim_0.7/augments/augment22",
                            "sim_0.7/augments/augment23",
                            "sim_0.7/augments/augment31",
                            "sim_0.7/augments/augment32",
                            "sim_0.7/augments/augment33"
                        ],
                        "sim_0.8": [
                            "sim_0.8/augments/augment11",
                            "sim_0.8/augments/augment12",
                            "sim_0.8/augments/augment13",
                            "sim_0.8/augments/augment21",
                            "sim_0.8/augments/augment22",
                            "sim_0.8/augments/augment23",
                            "sim_0.8/augments/augment31",
                            "sim_0.8/augments/augment32",
                            "sim_0.8/augments/augment33"
                        ],
                        "sim_0.9": [
                            "sim_0.9/augments/augment11",
                            "sim_0.9/augments/augment12",
                            "sim_0.9/augments/augment13",
                            "sim_0.9/augments/augment21",
                            "sim_0.9/augments/augment22",
                            "sim_0.9/augments/augment23",
                            "sim_0.9/augments/augment31",
                            "sim_0.9/augments/augment32",
                            "sim_0.9/augments/augment33"
                        ]
                    }
                },
                "augmented_instance": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment12",
                    "model_record/augments/augment13",
                    "model_record/augments/augment21",
                    "model_record/augments/augment22",
                    "model_record/augments/augment23",
                    "model_record/augments/augment31",
                    "model_record/augments/augment32",
                    "model_record/augments/augment33"
                ]
            }
        }
    }
}
