{
    "env": {
        "USE_GPU": 0,
        "IS_TRAIN_TEXT_CLASSIFIER": true,
        "IS_TRAIN_REINFORCER": true,
        "IS_GENERATE_AUGMENTED_DATA": true,
        "IS_AUGMENTED_DATA_FINETUNE": true
    },

    "dataset": {
        "select_dataset": "sst",
        "sst": {
            "granularity": "5-class"
        }
    },

    "text_model": {
        "embedder": {
            "pretrained_embedding": {
                "embedding_dim": 300,
                "pretrained_filepath": "pretrained_weight/glove.840B.300d.txt"
            },
            "embedding_dim": 300,
            "trainable": {
                "trainable": true,
                "projection_dim": 300
            }
        },
        "encoder": {
            "s2s_encoder": {
                "hidden_size": 300,
                "num_layers": 3,
                "bidirectional": true
            },
            "s2v_encoder": {
                "hidden_size": 300,
                "num_layers": 3,
                "bidirectional": true
            }
        },
        "classifier": {
            "feedforward": {
                "num_layers": 3,
                "hidden_dims": [300, 150, 75],
                "activations": "silu",
                "dropout": 0.3
            }
        },
        "optimizer": {
            "select_optimizer": "rmsprop",
            "lr": 1e-5
        },
        "scheduler": {
            "select_scheduler": "none"
        },
        "criterions": {
            "classification_criterion": "cross_entropy",
            "contrastive_criterion": "consine_embedding"
        },
        "evaluation": "categorical"
    },

    "reinforcer": {
        "environment": {
            "similarity_threshold": 0.90
        },

        "augmenter": {
            "synonyms": {
                "synonyms_filepath": null
            },
            "select_augmenter": [0, 1, 2, 3],
            "delete_augmenter": {
                "padded_idx": 0,
                "oov_idx": 0,
                "magnitude": 0.1
            },
            "swap_augmenter": {
                "padded_idx": 0,
                "oov_idx": 0,
                "magnitude": 1
            },
            "replace_augmenter": {
                "padded_idx": 0,
                "oov_idx": 0,
                "magnitude": 1
            },
            "insert_augmenter": {
                "padded_idx": 0,
                "oov_idx": 0,
                "magnitude": 1
            }
        },

        "policy": {
            "feedforward": {
                "num_layers": 3,
                "hidden_dims": [64, 32],
                "activations": "relu",
                "dropout": 0.3
            },

            "optimizer": {
                "select_optimizer": "adam",
                "lr": 1e-3
            }
        },

        "REINFORCE": {
            "gamma": 0.99,
            "clip_grad": 10,
            "max_step": 20
        }
    },

    "train_mode": {
        "select_mode": 2,
        "0": {
            "text_trainer": {
                "dataloader": {
                    "batch_size": 600,
                    "shuffle": true
                },
                "epochs": 36,
                "is_save": true
            },
            "reinforce_trainer": {
                "dataloader": {
                    "shuffle": false
                },
                "epochs": 2,
                "is_save": true,
                "is_writer": true,
                "batch_size": 600
            },
            "augmented_instance_generator": {
                "select_policy": [
                    "model_record/reinforce_model_weights/policy10",
                    "model_record/reinforce_model_weights/policy11",
                    "model_record/reinforce_model_weights/policy12"
                ],
                "save_name": [
                    "model_record/augments/augment10",
                    "model_record/augments/augment11",
                    "model_record/augments/augment12"
                ]
            },
            "text_finetuner": {
                "dataloader": {
                    "batch_size": 600,
                    "shuffle": true
                },
                "epochs": 24,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment10",
                    "model_record/augments/augment11",
                    "model_record/augments/augment12"
                ]
            }
        },
        "1": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },
            "reinforce_trainer": {
                "dataloader": {
                    "shuffle": false
                },
                "epochs": 2,
                "is_save": true,
                "is_writer": true,
                "batch_size": 600
            },
            "augmented_instance_generator": {
                "select_policy": [
                    "policy10",
                    "policy11",
                    "policy12"
                ],
                "save_name": [
                    "model_record/augments/augment10",
                    "model_record/augments/augment11",
                    "model_record/augments/augment12"
                ]
            },
            "text_finetuner": {
                "dataloader": {
                    "batch_size": 600,
                    "shuffle": true
                },
                "epochs": 24,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment10",
                    "model_record/augments/augment11",
                    "model_record/augments/augment12"
                ]
            }
        },
        "2": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },
            "augmented_instance_generator": {
                "select_policy": [
                    "model_record/reinforce_model_weights/policy10",
                    "model_record/reinforce_model_weights/policy11",
                    "model_record/reinforce_model_weights/policy12"
                ],
                "save_name": [
                    "model_record/augments/augment10",
                    "model_record/augments/augment11",
                    "model_record/augments/augment12"
                ]
            },
            "text_finetuner": {
                "dataloader": {
                    "batch_size": 600,
                    "shuffle": true
                },
                "epochs": 24,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment10",
                    "model_record/augments/augment11",
                    "model_record/augments/augment12"
                ]
            }
        },
        "3": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },
            "text_finetuner": {
                "dataloader": {
                    "batch_size": 600,
                    "shuffle": true
                },
                "epochs": 24,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment10",
                    "model_record/augments/augment11",
                    "model_record/augments/augment12"
                ]
            }
        }
    }
}
