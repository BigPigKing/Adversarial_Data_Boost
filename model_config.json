{
    "env": {
        "USE_GPU": 0
    },

    "dataset": {
        "select_dataset": "sst",
        "sst": {
            "granularity": "2-class",
            "proportion": 1
        },
        "yelp": {
            "proportion": 0.1
        }
    },

    "text_model": {
        "embedder": {
            "pretrained_embedding": {
                "embedding_dim": 300,
                "pretrained_filepath": "pretrained_weight/glove.840B.300d.txt"
            },
            "embedding_dim": 300,
            "trainable": {
                "trainable": true,
                "projection_dim": 300
            }
        },
        "encoder": {
            "s2s_encoder": {
                "hidden_size": 300,
                "num_layers": 3,
                "bidirectional": true
            },
            "s2v_encoder": {
                "hidden_size": 300,
                "num_layers": 3,
                "bidirectional": true
            }
        },
        "classifier": {
            "feedforward": {
                "num_layers": 3,
                "hidden_dims": [300, 150, 75],
                "activations": "silu",
                "dropout": 0.3
            }
        },
        "optimizer": {
            "select_optimizer": "rmsprop",
            "lr": 1e-5
        },
        "scheduler": {
            "select_scheduler": "reduce"
        },
        "criterions": {
            "classification_criterion": "cross_entropy",
            "contrastive_criterion": "consine_embedding"
        },
        "evaluation": "categorical",
        "clip_grad": {
            "is_clip": true,
            "max_norm": 0.9,
            "norm_type": 2
        }
    },

    "reinforcer": {
        "environment": {
            "similarity_threshold": 0.9
        },

        "augmenter": {
            "synonyms": {
                "synonyms_filepath": null
            },
            "select_augmenter": [0, 1, 2, 3],
            "delete_augmenter": {
                "padded_idx": 0,
                "oov_idx": 0,
                "magnitude": 0.1
            },
            "swap_augmenter": {
                "padded_idx": 0,
                "oov_idx": 0,
                "magnitude": 1
            },
            "replace_augmenter": {
                "padded_idx": 0,
                "oov_idx": 0,
                "magnitude": 1
            },
            "insert_augmenter": {
                "padded_idx": 0,
                "oov_idx": 0,
                "magnitude": 1
            }
        },

        "policy": {
            "feedforward": {
                "num_layers": 4,
                "hidden_dims": [64, 32, 16],
                "activations": "relu",
                "dropout": 0.2
            },

            "optimizer": {
                "select_optimizer": "adam",
                "lr": 1e-3
            }
        },

        "REINFORCE": {
            "gamma": 0.99,
            "clip_grad": 10,
            "max_step": 20
        }
    },

    "visualizer": {
        "mode": "isomap",
        "tsne": {
            "col_names": [
                "tsne_1",
                "tsne_2",
                "category"
            ],
            "n_components": 2,
            "perplexity": [
                5, 10, 15, 20, 30,
                40, 50, 60, 70, 80,
                90, 100, 110, 120, 130,
                140, 150, 200, 300, 500,
                750, 1000
            ],
            "n_iter": 1000,
            "verbose": 1,
            "save_fig_path": "model_record/visual/"
        },
        "isomap": {
            "col_names": [
                "isomap_1",
                "isomap_2",
                "category"
            ],
            "n_neighbors": 5,
            "n_components": 2,
            "n_jobs": -1,
            "save_fig_path": "model_record/visual/isomap/"
        }
    },

    "train_mode": {
        "select_mode": 1,
        "0": {
            "text_trainer": {
                "dataloader": {
                    "batch_size": 600,
                    "shuffle": true
                },
                "epochs": 39,
                "is_save": true
            },
            "reinforce_trainer": {
                "dataloader": {
                    "shuffle": true
                },
                "epochs": 3,
                "is_save": true,
                "is_writer": true,
                "batch_size": 600
            },
            "augmented_instance_generator": {
                "num_processor": 3,
                "select_policy": [
                    "model_record/reinforce_model_weights/policy11",
                    "model_record/reinforce_model_weights/policy12",
                    "model_record/reinforce_model_weights/policy13",
                    "model_record/reinforce_model_weights/policy21",
                    "model_record/reinforce_model_weights/policy22",
                    "model_record/reinforce_model_weights/policy23",
                    "model_record/reinforce_model_weights/policy31",
                    "model_record/reinforce_model_weights/policy32",
                    "model_record/reinforce_model_weights/policy33"
                ],
                "save_name": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment12",
                    "model_record/augments/augment13",
                    "model_record/augments/augment21",
                    "model_record/augments/augment22",
                    "model_record/augments/augment23",
                    "model_record/augments/augment31",
                    "model_record/augments/augment32",
                    "model_record/augments/augment33"
                ]
            },
            "text_finetuner": {
                "dataloader": {
                    "batch_size": 600,
                    "shuffle": true
                },
                "epochs": 36,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment12",
                    "model_record/augments/augment13",
                    "model_record/augments/augment21",
                    "model_record/augments/augment22",
                    "model_record/augments/augment23",
                    "model_record/augments/augment31",
                    "model_record/augments/augment32",
                    "model_record/augments/augment33"
                ]
            }
        },
        "1": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },
            "reinforce_trainer": {
                "dataloader": {
                    "shuffle": true
                },
                "epochs": 3,
                "is_save": true,
                "is_writer": true,
                "batch_size": 120
            },
            "augmented_instance_generator": {
                "num_processor": 3,
                "select_policy": [
                    "model_record/reinforce_model_weights/policy11",
                    "model_record/reinforce_model_weights/policy12",
                    "model_record/reinforce_model_weights/policy13",
                    "model_record/reinforce_model_weights/policy21",
                    "model_record/reinforce_model_weights/policy22",
                    "model_record/reinforce_model_weights/policy23",
                    "model_record/reinforce_model_weights/policy31",
                    "model_record/reinforce_model_weights/policy32",
                    "model_record/reinforce_model_weights/policy33"
                ],
                "save_name": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment12",
                    "model_record/augments/augment13",
                    "model_record/augments/augment21",
                    "model_record/augments/augment22",
                    "model_record/augments/augment23",
                    "model_record/augments/augment31",
                    "model_record/augments/augment32",
                    "model_record/augments/augment33"
                ]
            },
            "text_finetuner": {
                "dataloader": {
                    "batch_size": 600,
                    "shuffle": true
                },
                "epochs": 24,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment12",
                    "model_record/augments/augment13",
                    "model_record/augments/augment21",
                    "model_record/augments/augment22",
                    "model_record/augments/augment23",
                    "model_record/augments/augment31",
                    "model_record/augments/augment32",
                    "model_record/augments/augment33"
                ]
            }
        },
        "2": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },
            "augmented_instance_generator": {
                "num_processor": 4,
                "select_policy": [
                    "model_record/reinforce_model_weights/policy11",
                    "model_record/reinforce_model_weights/policy12",
                    "model_record/reinforce_model_weights/policy13",
                    "model_record/reinforce_model_weights/policy21",
                    "model_record/reinforce_model_weights/policy22",
                    "model_record/reinforce_model_weights/policy23",
                    "model_record/reinforce_model_weights/policy31",
                    "model_record/reinforce_model_weights/policy32",
                    "model_record/reinforce_model_weights/policy33"
                ],
                "save_name": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment12",
                    "model_record/augments/augment13",
                    "model_record/augments/augment21",
                    "model_record/augments/augment22",
                    "model_record/augments/augment23",
                    "model_record/augments/augment31",
                    "model_record/augments/augment32",
                    "model_record/augments/augment33"
                ]
            },
            "text_finetuner": {
                "dataloader": {
                    "batch_size": 600,
                    "shuffle": true
                },
                "epochs": 48,
                "is_save": false,
                "augmented_instance": [
                    "model_record/augments/augment56"
                ]
            }
        },
        "3": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },
            "text_finetuner": {
                "dataloader": {
                    "batch_size": 600,
                    "shuffle": true
                },
                "epochs": 1200,
                "is_save": false,
                "augmented_instance": [
                ]
            }
        },

        "4": {
            "pretrained_text_model": {
                "embedder": "model_record/text_model_weights/embedder.pkl",
                "encoder": "model_record/text_model_weights/encoder.pkl",
                "classifier": "model_record/text_model_weights/classifier.pkl"
            },

            "visualizer": {
                "batch_size": 1200,
                "proportion": 0.6,
                "augmented_instance": [
                    "model_record/augments/augment11",
                    "model_record/augments/augment12",
                    "model_record/augments/augment13",
                    "model_record/augments/augment21",
                    "model_record/augments/augment22",
                    "model_record/augments/augment23",
                    "model_record/augments/augment31",
                    "model_record/augments/augment32",
                    "model_record/augments/augment33"
                ]
            }
        }
    }
}
